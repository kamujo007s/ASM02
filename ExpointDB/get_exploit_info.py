import sys
import json
import pyxploitdb


def get_exploit_info(cve_id):
    db = pyxploitdb  # Use the local database
    exploits = db.searchCVE(cve_id)
    
    # Convert exploits to a dictionary that can be serialized to JSON
    exploit_list = []
    for exploit in exploits:
        exploit_data = {
            'id': exploit.id,
            'title': exploit.title,
            'description': exploit.description,
            'date': str(exploit.date),  # Convert date to string if needed
            'author': exploit.author,
            'platform': exploit.platform,
            'type': exploit.type,
            'port': exploit.port,
            'code': exploit.code,
        }
        exploit_list.append(exploit_data)
    
    return exploit_list

if __name__ == "__main__":
    cve_id = sys.argv[1]
    exploits = get_exploit_info(cve_id)
    print(json.dumps(exploits, indent=2))
